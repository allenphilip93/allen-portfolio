<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Newton's method for finding roots</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel='icon' href='../images/favicon.ico' type='image/x-icon'/>
    <link href="https://fonts.googleapis.com/css?family=Poppins:300,400,700" rel="stylesheet">

    <link rel="stylesheet" href="../css/open-iconic-bootstrap.min.css">
    <link rel="stylesheet" href="../css/animate.css">
    
    <link rel="stylesheet" href="../css/owl.carousel.min.css">
    <link rel="stylesheet" href="../css/owl.theme.default.min.css">
    <link rel="stylesheet" href="../css/magnific-popup.css">

    <link rel="stylesheet" href="../css/aos.css">

    <link rel="stylesheet" href="../css/ionicons.min.css">

    <link rel="stylesheet" href="../css/bootstrap-datepicker.css">
    <link rel="stylesheet" href="../css/jquery.timepicker.css">

    
    <link rel="stylesheet" href="../css/flaticon.css">
    <link rel="stylesheet" href="../css/icomoon.css">
    <link rel="stylesheet" href="../css/style.css">

    <link rel="stylesheet"
      href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/androidstudio.min.css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    <!-- Link to MathJax script from CDN -->
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML-full"></script>
    <!-- Configuration script -->
    <script type="text/x-mathjax-config">
      //Note the above <script> attribute type="text/x-mathjax-config" 
      MathJax.Hub.Config({
          TeX: { equationNumbers: {autoNumber: "AMS"} },
          tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]}
      });
    </script>
  </head>
  <body>

    <div class="KW_progressContainer">
      <div class="KW_progressBar">

      </div>
    </div>
    <div class="page">
    <nav id="colorlib-main-nav" role="navigation">
      <a href="#" class="js-colorlib-nav-toggle colorlib-nav-toggle active"><i></i></a>
      <div class="js-fullheight colorlib-table">
      	<div class="img" style="background-image: url(images/author-2.jpg);"></div>
        <div class="colorlib-table-cell js-fullheight">
          <div class="row no-gutters">
            <div class="col-md-12 text-center">
              <h1 class="mb-4"><a href="../index.html" class="logo">Allen Philip J</a></h1>
              <ul>
                <li><a href="../index.html"><span><small>01</small>Home</span></a></li>
                <li><a href="../about.html"><span><small>02</small>Resume</span></a></li>
                <li><a href="../services.html"><span><small>03</small>Services</span></a></li>
                <li><a href="../portfolio.html"><span><small>04</small>Portfolio</span></a></li>
                <li class="active"><a href="../blog.html"><span><small>05</small>Blog</span></a></li>
                <li><a href="../contact.html"><span><small>06</small>Contact</span></a></li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </nav>
    
    <div id="colorlib-page">
      <header>
        <div class="container">
          <div class="row">
            <div class="col-md-12">
              <div class="colorlib-navbar-brand">
                <a class="colorlib-logo" href="../blog.html"><span class="logo-img" style="background-image: url(images/person_1.jpg);"></span>Allen Philip J</a>
              </div>
              <a href="#" class="js-colorlib-nav-toggle colorlib-nav-toggle"><i></i></a>
            </div>
          </div>
        </div>
      </header>

      <section class="ftco-section">
        <div class="container mt-5">
        	<div class="row justify-content-center mb-5 pb-5">
            <div class="col-md-7 text-center heading-section ftco-animate">
              <span>Blog</span>
              <h2>Newton's method for finding roots</h2>
            </div>
          </div>
          <div class="row d-flex justify-content-center">
            <div class="col-md-8">
              <h2 class="mb-3">#1. What is the problem statement?</h2>
              <p>Given the following equation $$f(x)=0$$ we want to find the roots of the equation, i.e for what values of $x$ the function $f(x)$ goes to $0$. We assume that $f(x)$ is continuous and differentiable and a root exists.</p>
              
              <h2 class="mb-3">#2. Newton's method</h2>
              <p>In 1664, Issac Newton came up with an iterative method to solve this problem. However, this method is sometimes also known as the Raphson's method since Raphson invented the same algorithm a few years after Newton published it.</p>
              <p>The input to Newton's method takes in the function $f(x)$ as well as initial approximate guess $x_i$ for the root.</p>
              <p>Newton's method attempts to iteratively to improve the guess. According to the method, the next guess $x_{i+1}$ would be $$x_{i+1} = x_i - \frac{f(x_i)}{f'(x_i)} $$</p>
              <p>We iteratively repeat this until $f(x_{i+1}) \approx 0$</p>
              <p>The next guess $x_{i+1}$ is computed by drawing a tangent to the function $f(x)$ at ${x_i}$ and the point where the tangent intersects with the X-axis will be $x_{i+1}$.</p>

              <h2 class="mb-3">#3. Mathematics behind Newton's method</h2>
              <p>We know that the equation of a line is $$ \begin{equation} y = mx + c \end{equation} $$</p>
              <p>Let's say that our starting guess is $x_i$. The slope at $x_i$ on $f(x)$ will be the differential at $x_i$ which is $f'(x_i)$. Also we know that $(x_i, f(x_i)$ lies on the line, so we can substitute the point into $(1)$.</p>
              <p>$$f(x_i) = x_i f'(x_i) + c $$ Rearranging the terms we get: $$ c = f(x_i) - x_i f'(x_i) $$ Equation $(1)$ now becomes: $$ \begin{equation} y = x f'(x_i) + f(x_i) - x_i f'(x_i) \end{equation} $$</p>
              <p>Now we know that when this line intersects the X-axis, $y=0$ and let's say $x = x_{i+1}$ Substituting this into equation $(2)$ we get: $$ 0 = x_{i+1} f'(x_i) + f(x_i) - x_i f'(x_i) $$ $$ \begin{equation} x_{i+1} = x_i - \frac{f(x_i)}{f'(x_i)} \end{equation} $$ </p>


              <h2 class="mb-3">#4. Example using Newton's method</h2>
              <p>Consider a quadratic function $$ f(x) = x^2 - 4 $$ We know that $$ f'(x) = 2x $$ Substitute the values into equation (3) $$ \begin{equation} x_{i+1} = x_i - \frac{x_i^2 - 4}{2 x_i} \end{equation} $$ Let's say $x_0 = 1$. After the first iteration $$ x_1 = 2.5 $$ It's quite clear we have overshot the root at $x=2$. So let's see what will the guess after one more iteration but substituting $x_1 = 2.5$ into equation (4) $$ x_2 = 2.05 $$ Values for the next few iterations look like $$ x_3 = 2.000609756097561 $$ $$ x_4 = 2.0000000929222947 $$ </p>

              <h2 class="mb-3">#5. Does Newton's method always converge?</h2>
              <p>We can observe from the above example for quadratic functions, newton's method converges as long as a root exists since the second order derivative is constant. This means our approximation gets better with each iteration.</p>
              <p>Wiki has a more formal proof on the <a href="https://en.wikipedia.org/wiki/Newton%27s_method#Proof_of_quadratic_convergence_for_Newton%27s_iterative_method">quadratic convergence of Newton's method</a>.</p>
              <p>But more higher order functions like say a cubic function, <a href="https://math.stackexchange.com/questions/2407659/why-does-the-newton-raphson-method-not-converge-for-some-functions/2407690#:~:text=8%20Answers&text=Newton%27s%20method%20does%20not%20always,can%20have%20highly%20nontrivial%20dynamics.">convergence is not guarenteed</a> since based on the starting point of the guess and the other local peaks, it might end up <a href="https://www.wolframalpha.com/input/?i=Use+Newton%27s+method+to+solve+-0.74+%2B+0.78*x+%2B+1.1*x%5E2+-+3.55*x%5E3+%3D+0+with+x0+%3D+0.54">oscillating indefinitely and never find a solution</a>.</p>

              <h2 class="mb-3">#6. Applications of Newton's method</h2>
              <p>The more direct implementation is in finding the square root of a rational number within a certain error.</p>
              <pre><code class="java hljs">double sqrt_newton(double n) {
  const double eps = 1E-15;
  double x = 1;
  for (;;) {
      double nx = (x + n / x) / 2;
      if (abs(x - nx) < eps)
          break;
      x = nx;
  }
  return x;
}</code></pre>
              <p>Another variant is when we want to find the integer root of a number. Finding the large $x$ such that $x^2 \le n$.</p>
              <pre><code class="java hljs">int isqrt_newton(int n) {
  int x = 1;
  bool decreased = false;
  for (;;) {
      int nx = (x + n / x) >> 1;
      if (x == nx || nx > x && decreased)
          break;
      decreased = nx < x;
      x = nx;
  }
  return x;
}</code></pre>
              <p>For calculating square root of large numbers it is simple and effective to take the initial guess as $ 2 ^ {nbits/2} $ where $ nbits $ is the number of bits in the number $ N $.</p>

              <div class="tag-widget post-tag-container mb-5 mt-5">
                <div class="tagcloud">
                  <a href="#" class="tag-cloud-link">Math</a>
                  <a href="#" class="tag-cloud-link">Algorithm</a>
                </div>
              </div>
              
              <div class="about-author d-flex pt-5">
                <div class="bio align-self-md-center mr-4">
                  <img src="../images/person_1.jpg" alt="Image placeholder" class="img-fluid mb-4">
                </div>
                <div class="desc align-self-md-center">
                  <h3>About The Author</h3>
                  <p>Allen Philip is a passionate software engineer with over 6 years of experience dunking coffee, starring at screen, pulling out hair strands and changing the world one commit at a time.</p>
                </div>
              </div>

            </div> <!-- .col-md-8 -->

          </div>
        </div>
      </section>
      
      <footer class="ftco-footer ftco-bg-dark ftco-section">
        <div class="container">
          <div class="row mb-5 justify-content-center">
            <div class="col-md-5 text-center">
              <div class="ftco-footer-widget mb-5">
                <ul class="ftco-footer-social list-unstyled">
                  <li class="ftco-animate"><a href="#"><span class="icon-twitter"></span></a></li>
                  <li class="ftco-animate"><a href="#"><span class="icon-facebook"></span></a></li>
                  <li class="ftco-animate"><a href="#"><span class="icon-instagram"></span></a></li>
                </ul>
              </div>
              <div class="ftco-footer-widget">
                <h2 class="mb-3">Contact Us</h2>
                <p class="h3 email"><a href="#">info@email.com</a></p>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-md-12 text-center">

              <p><!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
      Copyright &copy;<script>document.write(new Date().getFullYear());</script> All rights reserved | This template is made with <i class="icon-heart" aria-hidden="true" style="color: red;"></i> by <a href="https://colorlib.com" target="_blank">Colorlib</a>
      <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. --></p>
            </div>
          </div>
        </div>
      </footer>

      <!-- loader -->
      <div id="ftco-loader" class="show fullscreen"><svg class="circular" width="48px" height="48px"><circle class="path-bg" cx="24" cy="24" r="22" fill="none" stroke-width="4" stroke="#eeeeee"/><circle class="path" cx="24" cy="24" r="22" fill="none" stroke-width="4" stroke-miterlimit="10" stroke="#F96D00"/></svg></div>

      </div>

    </div>


    <script src="../js/jquery.min.js"></script>
    <script src="../js/jquery-migrate-3.0.1.min.js"></script>
    <script src="../js/popper.min.js"></script>
    <script src="../js/bootstrap.min.js"></script>
    <script src="../js/jquery.easing.1.3.js"></script>
    <script src="../js/jquery.waypoints.min.js"></script>
    <script src="../js/jquery.stellar.min.js"></script>
    <script src="../js/owl.carousel.min.js"></script>
    <script src="../js/jquery.magnific-popup.min.js"></script>
    <script src="../js/aos.js"></script>
    <script src="../js/jquery.animateNumber.min.js"></script>
    <script src="../js/scrollax.min.js"></script>
    <script src="../js/bootstrap-datepicker.js"></script>
    <script src="../js/jquery.timepicker.min.js"></script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBVWaKrjvy3MaE7SQ74_uJiULgl1JY0H2s&sensor=false"></script>
    <script src="../js/google-map.js"></script>
    <script src="../js/main.js"></script>
    
  </body>
</html>